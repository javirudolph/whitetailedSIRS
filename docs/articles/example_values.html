<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="whitetailedSIRS">
<title>example_values • whitetailedSIRS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="example_values">
<meta property="og:description" content="whitetailedSIRS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">whitetailedSIRS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example_values.html">example_values</a>
    <a class="dropdown-item" href="../articles/sir_model_description.html">sir_model_description</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/javirudolph/whitetailedSIRS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>example_values</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/javirudolph/whitetailedSIRS/blob/HEAD/vignettes/example_values.Rmd" class="external-link"><code>vignettes/example_values.Rmd</code></a></small>
      <div class="d-none name"><code>example_values.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/javirudolph/whitetailedSIRS" class="external-link">whitetailedSIRS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://desolve.r-forge.r-project.org/" class="external-link">deSolve</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rootSolve</span><span class="op">)</span></span></code></pre></div>
<p>As a first example, we will use the defaults for all the values, and
run one projection of the SIRS model. These defaults are produced as
random draws from the expert elicitation data.</p>
<p>First, load the data, and generate a random sample for each of the
parameters:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">23</span><span class="op">)</span></span>
<span><span class="va">nsamples</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">elicitation_data</span> <span class="op">&lt;-</span> <span class="fu">whitetailedSIRS</span><span class="fu">::</span><span class="va">elicitation_data</span></span>
<span><span class="co"># bind samples to the elicitation df</span></span>
<span><span class="va">elicitation_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="co"># create a random sample using the parameters depending on the specified distribution</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>my_sample <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">family</span> <span class="op">==</span> <span class="st">"log-normal"</span>,</span>
<span>                              <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sd</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sd</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">nsamples</span>, <span class="va">mu</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sd</span><span class="op">)</span>,</span>
<span>                                   <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sd</span><span class="op">)</span> <span class="fu">greybox</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/greybox/man/LogitNormal.html" class="external-link">rlogitnorm</a></span><span class="op">(</span><span class="va">nsamples</span>, <span class="va">mu</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">elicitation_data</span></span></code></pre></div>
<p>With the previous code we generated a sample of 50 values for each of
the parameters elicited, using the appropriate distribution. We will use
some of those parameters now to calculate our transmission terms and
other parameters that go into the SIRS model. The
<code>elicitation_data</code> object is a tibble, and the sample of
values for each parameter is a vector of values within each cell of the
tibble for the <code>my_sample</code> column:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span><span class="va">elicitation_data</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;   parameter                  mu    sd family     my_sample </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Temporary Immunity     4.72   0.626 log-normal <span style="color: #949494;">&lt;dbl [50]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Wastewater Infections -<span style="color: #BB0000;">1.35</span>   1.49  log-normal <span style="color: #949494;">&lt;dbl [50]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Fomite Infections     -<span style="color: #BB0000;">0.041</span><span style="color: #BB0000; text-decoration: underline;">4</span> 1.03  log-normal <span style="color: #949494;">&lt;dbl [50]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Viral Load             0.216  0.344 log-normal <span style="color: #949494;">&lt;dbl [50]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Dose-Response          0.277  0.272 log-normal <span style="color: #949494;">&lt;dbl [50]&gt;</span></span></span></code></pre></div>
<p>We write a short helper function to help us extract each of the
vectors in the <code>my_sample</code> column, so these can be assigned
to the different parameters:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_param_val</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">my_param</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">elicitation_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">parameter</span> <span class="op">==</span> <span class="va">my_param</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">my_sample</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">my_sample</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We set up all the parameters that were generated from the expert
elicitation distributions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The immunity parameter that goes into the SIR is the reciprocal to what was elicited</span></span>
<span><span class="va">alpha_immunity</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">'Temporary Immunity'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate contact rate between wild deer using the contact_rate fx using defaults:</span></span>
<span><span class="va">c_ww</span> <span class="op">&lt;-</span> <span class="fu">whitetailedSIRS</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_contact_rate.html">calc_contact_rate</a></span><span class="op">(</span>nsamples <span class="op">=</span> <span class="va">nsamples</span><span class="op">)</span></span>
<span><span class="co"># The rest of the contact rates were elicited and then modified</span></span>
<span><span class="va">c_cw</span> <span class="op">&lt;-</span> <span class="fl">0.00072</span> <span class="op">/</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Direct Contact Probability"</span><span class="op">)</span></span>
<span><span class="va">c_cc</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Deer-Deer Proximity Rate, Captive (per day)"</span><span class="op">)</span></span>
<span><span class="va">c_hw</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Deer-Human Proximity Rate, Rural (per 120 days)"</span><span class="op">)</span> <span class="op">/</span> <span class="fl">120</span></span>
<span><span class="va">c_hc</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Deer-Human Proximity Rate, Captive (per 120 days)"</span><span class="op">)</span> <span class="op">/</span><span class="fl">120</span></span>
<span></span>
<span><span class="co"># time or duration of these contacts was also expert elicited:</span></span>
<span><span class="va">t_contact_deer_deer</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Deer Proximity Duration (minutes)"</span><span class="op">)</span></span>
<span><span class="va">t_contact_deer_human_rural</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Deer-Human Proximity Duration, Rural (minutes)"</span><span class="op">)</span></span>
<span><span class="va">t_contact_deer_human_capt</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Deer-Human Proximity Duration, Captive (minutes)"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Viral load proportional to human value:</span></span>
<span><span class="va">C_nu</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fl">5.6</span> <span class="op">*</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Viral Load"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dose response</span></span>
<span><span class="va">r_deer</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Dose-Response"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direct contact probability:</span></span>
<span><span class="va">sigma_dc_wild</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Direct Contact Probability"</span><span class="op">)</span></span>
<span><span class="va">sigma_dc_captive</span> <span class="op">&lt;-</span> <span class="fu">get_param_val</span><span class="op">(</span><span class="st">"Direct Contact Probability"</span><span class="op">)</span></span></code></pre></div>
<p>Using the sets of parameters from expert elicitation we calculate
probability of infection via aerosol and direct contact. These
calculations are also informed by parameters from the literature, and
details on this can be found in the <code>sir_model_description</code>
document/article.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aerosol</span></span>
<span><span class="va">nu_aero_deer_deer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_nu_aero.html">calc_nu_aero</a></span><span class="op">(</span>C_nu <span class="op">=</span> <span class="va">C_nu</span>,</span>
<span>                                  t_contact <span class="op">=</span> <span class="va">t_contact_deer_deer</span> <span class="op">/</span> <span class="fl">60</span>,</span>
<span>                                  r <span class="op">=</span> <span class="va">r_deer</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nu_aero_deer_human_rural</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_nu_aero.html">calc_nu_aero</a></span><span class="op">(</span>ER <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.53</span>, <span class="va">nsamples</span><span class="op">)</span>, C_nu <span class="op">=</span> <span class="va">C_nu</span>, t_contact <span class="op">=</span> <span class="va">t_contact_deer_human_rural</span><span class="op">/</span><span class="fl">60</span>, r <span class="op">=</span> <span class="va">r_deer</span><span class="op">)</span></span>
<span><span class="va">nu_aero_deer_human_capt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_nu_aero.html">calc_nu_aero</a></span><span class="op">(</span>ER <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.53</span>, <span class="va">nsamples</span><span class="op">)</span>, C_nu <span class="op">=</span> <span class="va">C_nu</span>, t_contact <span class="op">=</span> <span class="va">t_contact_deer_human_capt</span><span class="op">/</span><span class="fl">60</span>, r <span class="op">=</span> <span class="va">r_deer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># direct contact</span></span>
<span><span class="va">nu_dc_deer_deer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_nu_dc.html">calc_nu_dc</a></span><span class="op">(</span>C_nu <span class="op">=</span> <span class="va">C_nu</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have all the parameters we need, we can set up the inputs
for the <code><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode()</a></code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>   S_wild <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   I_wild <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   R_wild <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   S_captive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   I_captive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   R_captive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsamples</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>   alpha_immunity <span class="op">=</span> <span class="va">alpha_immunity</span>,</span>
<span>   beta_aero_ww <span class="op">=</span> <span class="va">c_ww</span> <span class="op">*</span> <span class="va">nu_aero_deer_deer</span>,</span>
<span>   beta_aero_cw <span class="op">=</span> <span class="va">c_cw</span> <span class="op">*</span> <span class="va">nu_aero_deer_deer</span>,</span>
<span>   beta_aero_cc <span class="op">=</span> <span class="va">c_cc</span> <span class="op">*</span> <span class="va">nu_aero_deer_deer</span>,</span>
<span>   beta_aero_hw <span class="op">=</span> <span class="va">c_hw</span> <span class="op">*</span> <span class="va">nu_aero_deer_human_rural</span>,</span>
<span>   beta_aero_hc <span class="op">=</span> <span class="va">c_hc</span> <span class="op">*</span> <span class="va">nu_aero_deer_human_capt</span>,</span>
<span>   beta_dc_ww <span class="op">=</span> <span class="va">c_ww</span> <span class="op">*</span> <span class="va">sigma_dc_wild</span> <span class="op">*</span> <span class="va">nu_dc_deer_deer</span>,</span>
<span>   beta_dc_cw <span class="op">=</span> <span class="va">c_cw</span> <span class="op">*</span> <span class="va">sigma_dc_wild</span> <span class="op">*</span> <span class="va">nu_dc_deer_deer</span>,</span>
<span>   beta_dc_cc <span class="op">=</span> <span class="va">c_cc</span> <span class="op">*</span> <span class="va">sigma_dc_captive</span> <span class="op">*</span> <span class="va">nu_dc_deer_deer</span>,</span>
<span>   phi_cw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   phi_wc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   gamma_recov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="va">nsamples</span><span class="op">)</span>,</span>
<span>   I_human <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="va">nsamples</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">120</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We continue to work with list columns here so we can keep track of
the sets of parameters associated to each of the projections:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create list column to store inits and params</span></span>
<span><span class="va">mytibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>run_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsamples</span>,</span>
<span>                   inits <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">run_id</span>, <span class="op">~</span> <span class="va">list_inits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   params <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">run_id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">list_params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new column that stores the results from the ode() projection</span></span>
<span></span>
<span><span class="va">mytibble</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ode_proj <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">inits</span>, parms <span class="op">=</span> <span class="va">params</span><span class="op">)</span>, <span class="va">ode</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">120</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, func <span class="op">=</span> <span class="va">simple_sirs</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="co"># now create another column that stores the equilibrium for these:</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>steady_state <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">inits</span>, parms <span class="op">=</span> <span class="va">params</span><span class="op">)</span>, <span class="va">runsteady</span>, func <span class="op">=</span> <span class="va">simple_sirs</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">sirs_results</span> <span class="co"># save as new object</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span><span class="va">sirs_results</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   run_id inits     params     ode_proj            steady_state    </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1 <span style="color: #949494;">&lt;dbl [6]&gt;</span> <span style="color: #949494;">&lt;dbl [13]&gt;</span> <span style="color: #949494;">&lt;deSolve [121 × 7]&gt;</span> <span style="color: #949494;">&lt;named list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2 <span style="color: #949494;">&lt;dbl [6]&gt;</span> <span style="color: #949494;">&lt;dbl [13]&gt;</span> <span style="color: #949494;">&lt;deSolve [121 × 7]&gt;</span> <span style="color: #949494;">&lt;named list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3 <span style="color: #949494;">&lt;dbl [6]&gt;</span> <span style="color: #949494;">&lt;dbl [13]&gt;</span> <span style="color: #949494;">&lt;deSolve [121 × 7]&gt;</span> <span style="color: #949494;">&lt;named list [1]&gt;</span></span></span></code></pre></div>
<p>From our results we can visualize the proportion of infected
individuals over time for each of the runs:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get results in proper format:</span></span>
<span><span class="va">sirs_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ode_df <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">ode_proj</span>, <span class="va">as.data.frame</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">ode_df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"run_id"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ode_df</span></span>
<span></span>
<span><span class="va">ode_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">I_wild</span>, group <span class="op">=</span> <span class="va">run_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time in days"</span>, y <span class="op">=</span> <span class="st">"Proportion of I_w individuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_values_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>We can also take a look at how all compartments change over time:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ode_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">run_id</span>, <span class="va">time</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"compartment"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">run_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">compartment</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time in days"</span>, y <span class="op">=</span> <span class="st">"Proportion of population"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_values_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>And check the steady state, or equilibrium, for all of these
runs:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sirs_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>steady_sir <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">steady_state</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span>          steady_sir <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">steady_sir</span>, <span class="va">as_tibble_row</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">steady_sir</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"run_id"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">steady_sir</span></span>
<span></span>
<span><span class="va">steady_sir</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">run_id</span>, names_to <span class="op">=</span> <span class="st">"compartment"</span>, values_to <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">compartment</span>, sep <span class="op">=</span> <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sir_type"</span>, <span class="st">"pop_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sir_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sir_type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          pop_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pop_type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wild"</span>, <span class="st">"captive"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">proportion</span>, color <span class="op">=</span> <span class="va">pop_type</span>, x <span class="op">=</span> <span class="va">sir_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, color <span class="op">=</span> <span class="st">"Population Type"</span>, y <span class="op">=</span> <span class="st">"Proportion at equilibrium"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_values_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>We can also calculate some</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
